--// GATORHAX v3.3 PRO (FINAL FULL SCRIPT)
--// LocalScript ONLY

-- SERVICES
local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local VirtualUser = game:GetService("VirtualUser")

local player = Players.LocalPlayer
local camera = workspace.CurrentCamera

-- REMOVE OLD GUI
pcall(function()
	player.PlayerGui.GATORHAX_GUI:Destroy()
end)

-- GUI
local gui = Instance.new("ScreenGui", player.PlayerGui)
gui.Name = "GATORHAX_GUI"
gui.ResetOnSpawn = false

-- AUTO SCALE
local scale = Instance.new("UIScale", gui)
local function updateScale()
	scale.Scale = math.clamp(camera.ViewportSize.X / 1920, 0.7, 1)
end
updateScale()
camera:GetPropertyChangedSignal("ViewportSize"):Connect(updateScale)

-- MAIN FRAME
local main = Instance.new("Frame", gui)
main.Size = UDim2.fromScale(0.45, 0.6)
main.Position = UDim2.fromScale(0.275, 0.2)
main.BackgroundColor3 = Color3.fromRGB(16,16,16)
main.BackgroundTransparency = 0
main.Active = true
main.Draggable = true
main.BorderSizePixel = 0
Instance.new("UICorner", main).CornerRadius = UDim.new(0,18)
Instance.new("UIStroke", main).Color = Color3.fromRGB(0,255,170)

-- TITLE
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,50)
title.BackgroundTransparency = 1
title.Text = "GATORHAX v3.3 PRO"
title.Font = Enum.Font.GothamBold
title.TextSize = 22
title.TextColor3 = Color3.fromRGB(0,255,170)

-- CONTENT
local content = Instance.new("Frame", main)
content.Position = UDim2.new(0.22,0,0,55)
content.Size = UDim2.new(0.75,0,1,-65)
content.BackgroundTransparency = 1

-- TABS (LEFT)
local tabs = Instance.new("Frame", main)
tabs.Position = UDim2.new(0.02,0,0.12,0)
tabs.Size = UDim2.new(0.18,0,0.75,0)
tabs.BackgroundTransparency = 1
local tabLayout = Instance.new("UIListLayout", tabs)
tabLayout.Padding = UDim.new(0,10)

-- HELPERS
local function card(parent,h)
	local f = Instance.new("Frame", parent)
	f.Size = UDim2.new(1,0,0,h)
	f.BackgroundColor3 = Color3.fromRGB(26,26,26)
	Instance.new("UICorner", f).CornerRadius = UDim.new(0,12)
	return f
end

local function btn(parent,text)
	local b = Instance.new("TextButton", parent)
	b.Size = UDim2.new(1,0,1,0)
	b.BackgroundTransparency = 1
	b.Text = text
	b.Font = Enum.Font.Gotham
	b.TextSize = 15
	b.TextColor3 = Color3.fromRGB(255,255,255)
	return b
end

local function box(parent,placeholder)
	local t = Instance.new("TextBox", parent)
	t.Size = UDim2.new(1,0,1,0)
	t.BackgroundTransparency = 1
	t.PlaceholderText = placeholder
	t.Font = Enum.Font.Gotham
	t.TextSize = 16
	t.TextColor3 = Color3.fromRGB(0,255,170)
	return t
end

-- PAGES (SAFE)
local pages = {}
local function newPage(name)
	local f = Instance.new("Frame", content)
	f.Size = UDim2.new(1,0,1,0)
	f.BackgroundTransparency = 1
	f.Visible = false
	pages[name] = f
	local layout = Instance.new("UIListLayout", f)
	layout.Padding = UDim.new(0,12)
	return f
end

local pageMain = newPage("Main")
local pageFeatures = newPage("Features")
local pageServer = newPage("Server")
local pageInfo = newPage("Info")

-- TAB BUTTON
local function tabButton(text)
	local b = Instance.new("TextButton", tabs)
	b.Size = UDim2.new(1,0,0,42)
	b.Text = text
	b.Font = Enum.Font.GothamBold
	b.TextSize = 14
	b.BackgroundColor3 = Color3.fromRGB(26,26,26)
	b.TextColor3 = Color3.fromRGB(180,180,180)
	b.AutoButtonColor = false
	Instance.new("UICorner", b).CornerRadius = UDim.new(0,10)
	return b
end

local tMain = tabButton("Main")
local tFeatures = tabButton("Features")
local tServer = tabButton("Server")
local tInfo = tabButton("Info")

local function showPage(name, btn)
	for _,p in pairs(pages) do p.Visible = false end
	for _,b in pairs(tabs:GetChildren()) do
		if b:IsA("TextButton") then
			b.BackgroundColor3 = Color3.fromRGB(26,26,26)
			b.TextColor3 = Color3.fromRGB(180,180,180)
		end
	end
	pages[name].Visible = true
	btn.BackgroundColor3 = Color3.fromRGB(0,255,170)
	btn.TextColor3 = Color3.fromRGB(10,10,10)
end

tMain.MouseButton1Click:Connect(function() showPage("Main", tMain) end)
tFeatures.MouseButton1Click:Connect(function() showPage("Features", tFeatures) end)
tServer.MouseButton1Click:Connect(function() showPage("Server", tServer) end)
tInfo.MouseButton1Click:Connect(function() showPage("Info", tInfo) end)
showPage("Main", tMain)

-- ================= MAIN =================

-- FPS MONITOR
local fpsLabel = Instance.new("TextLabel", card(pageMain,45))
fpsLabel.Size = UDim2.new(1,0,1,0)
fpsLabel.BackgroundTransparency = 1
fpsLabel.Font = Enum.Font.GothamBold
fpsLabel.TextSize = 15
fpsLabel.TextColor3 = Color3.fromRGB(0,255,170)
fpsLabel.Text = "FPS : ..."

local frames = 0
local lastTime = os.clock()
local currentFPS = 60

RunService.RenderStepped:Connect(function()
	frames += 1
	local now = os.clock()
	if now - lastTime >= 1 then
		currentFPS = frames
		fpsLabel.Text = "FPS : "..currentFPS
		frames = 0
		lastTime = now
	end
end)

-- ANTI FPS
local antiFPS = false
btn(card(pageMain,45),"Anti FPS Drop : OFF").MouseButton1Click:Connect(function(self)
	antiFPS = not antiFPS
	Lighting.GlobalShadows = not antiFPS
	self.Text = "Anti FPS Drop : "..(antiFPS and "ON" or "OFF")
end)

-- ANTI AFK
local antiAFK = false
local afkConn
btn(card(pageMain,45),"Anti AFK : OFF").MouseButton1Click:Connect(function(self)
	antiAFK = not antiAFK
	if antiAFK then
		afkConn = player.Idled:Connect(function()
			VirtualUser:CaptureController()
			VirtualUser:ClickButton2(Vector2.new())
		end)
	else
		if afkConn then afkConn:Disconnect() end
	end
	self.Text = "Anti AFK : "..(antiAFK and "ON" or "OFF")
end)

-- ================= FEATURES =================

local walkSpeed = 16
local jumpPower = 50
local flySpeed = 80
local flyEnabled = false
local flyBV, flyBG

local wsBox = box(card(pageFeatures,45),"WalkSpeed (ENTER)")
wsBox.FocusLost:Connect(function(e)
	if e then
		local v = tonumber(wsBox.Text)
		if v then walkSpeed = math.clamp(v,0,500) end
	end
end)

local jpBox = box(card(pageFeatures,45),"JumpPower (ENTER)")
jpBox.FocusLost:Connect(function(e)
	if e then
		local v = tonumber(jpBox.Text)
		if v then jumpPower = math.clamp(v,0,500) end
	end
end)

local fsBox = box(card(pageFeatures,45),"FlySpeed (ENTER)")
fsBox.FocusLost:Connect(function(e)
	if e then
		local v = tonumber(fsBox.Text)
		if v then flySpeed = math.clamp(v,10,300) end
	end
end)

local flyBtn = btn(card(pageFeatures,45),"Fly : OFF")
flyBtn.MouseButton1Click:Connect(function()
	flyEnabled = not flyEnabled
	flyBtn.Text = "Fly : "..(flyEnabled and "ON" or "OFF")

	local char = player.Character
	local hrp = char and char:FindFirstChild("HumanoidRootPart")
	if not hrp then return end

	if flyEnabled then
		flyBV = Instance.new("BodyVelocity", hrp)
		flyBV.MaxForce = Vector3.new(1e5,1e5,1e5)
		flyBG = Instance.new("BodyGyro", hrp)
		flyBG.MaxTorque = Vector3.new(1e5,1e5,1e5)
	else
		if flyBV then flyBV:Destroy() end
		if flyBG then flyBG:Destroy() end
	end
end)

-- APPLY SPEED + FLY
RunService.Heartbeat:Connect(function()
	local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
	if hum then
		hum.WalkSpeed = walkSpeed
		hum.JumpPower = jumpPower
	end

	if flyEnabled and flyBV and flyBG then
		local dir = Vector3.zero
		if UIS:IsKeyDown(Enum.KeyCode.W) then dir += camera.CFrame.LookVector end
		if UIS:IsKeyDown(Enum.KeyCode.S) then dir -= camera.CFrame.LookVector end
		if UIS:IsKeyDown(Enum.KeyCode.A) then dir -= camera.CFrame.RightVector end
		if UIS:IsKeyDown(Enum.KeyCode.D) then dir += camera.CFrame.RightVector end
		if UIS:IsKeyDown(Enum.KeyCode.Space) then dir += camera.CFrame.UpVector end
		if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then dir -= camera.CFrame.UpVector end
		flyBV.Velocity = dir.Magnitude > 0 and dir.Unit * flySpeed or Vector3.zero
		flyBG.CFrame = camera.CFrame
	end
end)

player.CharacterAdded:Connect(function()
	flyEnabled = false
	if flyBV then flyBV:Destroy() end
	if flyBG then flyBG:Destroy() end
end)

-- ================= INFO =================
local info = Instance.new("TextLabel", pageInfo)
info.Size = UDim2.new(1,0,1,0)
info.BackgroundTransparency = 1
info.Text = "GATORHAX\nv3.3 PRO\nPC ONLY"
info.Font = Enum.Font.GothamBold
info.TextSize = 18
info.TextColor3 = Color3.fromRGB(0,255,170)

-- AUTO GUI TRANSPARENCY (FPS + SCREEN)
RunService.RenderStepped:Connect(function()
	local t
	if currentFPS < 45 then
		t = 0.35
	elseif currentFPS < 60 then
		t = 0.25
	else
		t = 0.15
	end
	if camera.ViewportSize.X < 1200 then
		t += 0.05
	end
	main.BackgroundTransparency = math.clamp(t,0,0.45)
end)

-- INSERT TOGGLE
UIS.InputBegan:Connect(function(input,gp)
	if not gp and input.KeyCode == Enum.KeyCode.Insert then
		main.Visible = not main.Visible
	end
end)
